<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - Módulo Farmacia</title>
  <link rel="stylesheet" href="source/estilos_farmacia.css">
</head>
<body>
  <div class="dashboard-header">
    <div class="header-content">
      <div class="logo-section">
        <span style="font-size: 40px;">🏥</span>
        <h1>Módulo Farmacia</h1>
      </div>
      <div class="user-section">
        <div class="user-info">
          <span>👤</span>
          <strong id="nombreUsuario">Farmacéutico</strong>
        </div>
        <button class="logout-btn" onclick="cerrarSesion()">
          🚪 Cerrar Sesión
        </button>
      </div>
    </div>
  </div>

  <div class="main-container"> 
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon">💊</div>
          <div class="stat-value">247</div>
        </div>
        <div class="stat-label">Productos en Stock</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon">📋</div>
          <div class="stat-value">15</div>
        </div>
        <div class="stat-label">Recetas Hoy</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon">💰</div>
          <div class="stat-value">S/ 2,450</div>
        </div>
        <div class="stat-label">Ventas del Día</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon">⚠️</div>
          <div class="stat-value">8</div>
        </div>
        <div class="stat-label">Stock Bajo</div>
      </div>
    </div>
    <div class="modules-grid">
      <a href="venta_receta.html" class="module-card">
        <span class="module-icon">📋</span>
        <h3 class="module-title">Venta por Receta</h3>
        <p class="module-description">
          Dispense medicamentos siguiendo prescripciones médicas registradas en el sistema
        </p>
      </a>

      <a href="venta_sin_receta.html" class="module-card">
        <span class="module-icon">🛒</span>
        <h3 class="module-title">Venta sin Receta</h3>
        <p class="module-description">
          Venta directa de medicamentos OTC y productos farmacéuticos
        </p>
      </a>
      <a href="Hventa.html" class="module-card">
        <span class="module-icon">📊</span>
        <h3 class="module-title">Historial de ventas</h3>
        <p class="module-description">
           Informes de ventas e información de compradores
        </p>
      </a>
    </div>
    
    <!-- Scripts -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // 🔐 Verificar sesión activa
      fetch('farmacia?accion=sesion', { credentials: 'include' })
        .then(response => {
          if (!response.ok) throw new Error('No autenticado');
          return response.json();
        })
        .then(data => {
          document.getElementById('nombreUsuario').textContent = data.usuario;
        })
        .catch(() => {
          window.location.href = 'inicio_sesion.html';
        });

      // 🔄 Actualizar estadísticas cada 30 segundos (a implementar si quieres backend dinámico)
      setInterval(actualizarEstadisticas, 30000);

      // 🎬 Animaciones suaves de aparición
      const cards = document.querySelectorAll('.stat-card, .module-card');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        setTimeout(() => {
          card.style.transition = 'all 0.5s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
      });
    });

    // 🔁 Placeholder para estadísticas dinámicas
    function actualizarEstadisticas() {
      console.log("Actualizando estadísticas...");
      // Aquí puedes hacer un fetch al backend para valores reales
    }

    // 🔓 Cerrar sesión
    function cerrarSesion() {
      fetch('farmacia', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: 'accion=cerrar'
      }).then(resp => {
        if (resp.ok) {
          window.location.href = 'inicio_sesion.html';
        }
      });
    }
  </script>

</body>
</html>